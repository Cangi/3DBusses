<html>
<head>
<script src="https://cdn-webgl.wrld3d.com/wrldjs/dist/latest/wrld.js"></script>
<script src="busRoutes.js"></script>
<script src="busStopList.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.0.1/leaflet.css" rel="stylesheet" />
<link rel="stylesheet" href="testcss.css">

</head>
<body>

	<div style="position: relative">
		<div id="map" style="height: 100%"></div>		
			<script>
			
			//create map 
			var map = L.Wrld.map("map", "c976700dbe05df6d18bdab38af2b1ae2", {center: [56.458522, -2.97107], zoom: 15});
						
			// create custom icon
    		var BusStop = L.Icon.extend({
    		options: {
        		iconSize:     [75, 75],
        		iconAnchor:   [32.5, 75],
        		popupAnchor:  [-3, -76]
    			}
			});

			//links to images used for stops
			var linkBusStop = 'https://cdn.iconscout.com/icon/premium/png-512-thumb/bus-stop-10-660162.png'
			var linkBusStation = 'https://cdn2.iconfinder.com/data/icons/large-home-icons/512/Bus_station_transportation_space.png'

			var stop1 = new BusStop({iconUrl: linkBusStop});
			var stopBusStation = new BusStop({iconUrl: linkBusStation});
    
    		L.icon = function (options) {
    			return new L.Icon(options);
			};
			
			var stopsArray = []
			var stationsArray = []

			for (i = 0; i < locations.length; i++) {  
				
				var stops = L.marker([locations[i][0], locations[i][1]], {icon: stop1}).bindPopup("Bus stop");
				stopsArray[i] = stops
		
      		};
      
      		for (i = 0; i < locationBusStations.length; i++) {  
	
        		var stations = L.marker([locationBusStations[i][0], locationBusStations[i][1]], {icon: stopBusStation}).bindPopup("Bus station");
        		stationsArray[i] = stations
      		};
      		
      		//Hide  BUS STOPS markers when zoomed out
      		var stopMarkers = new L.FeatureGroup();
      		
      		for (i = 0; i < locations.length; i++) {
      		
      			stopMarkers.addLayer(stopsArray[i]);
      		 }
      		
      		map.on('zoomend', function() {
    			if (map.getZoom() < 14){
            		map.removeLayer(stopMarkers);
    				}
    				else {
            		map.addLayer(stopMarkers);
        			}
			});
			
			//Hide  BUS STATIONS markers when zoomed out
			var stationMarkers = new L.FeatureGroup();
      		
      		for (i = 0; i < locationBusStations.length; i++) {
      		
      			stationMarkers.addLayer(stationsArray[i]);
      		 }
      		
      		map.on('zoomend', function() {
    			if (map.getZoom() < 14){
            		map.removeLayer(stationMarkers);
    				}
    				else {
            		map.addLayer(stationMarkers);
        			}
			});
			
			//CSS for the routes
			var BusRouteOptions =
			{
			'color': 'blue',
			'weight': '8',
			'opacity': '0.5',
			'smoothFactor': '1'
			}
			
			//creates each route
			var numberOneBus = L.polyline(numberOneBusRoute, BusRouteOptions).addTo(map);
			var numberFourBus = L.polyline(numberFourBusRoute, BusRouteOptions).addTo(map);
			var numberFiveBus = L.polyline(numberFiveBusRoute, BusRouteOptions).addTo(map);
			var numberTwentyThreeSBus = L.polyline(numberTwentyThreeSRoute, BusRouteOptions).addTo(map);
			var numberThirtyTwoBus = L.polyline(numberThirtyTwoBusRoute, BusRouteOptions).addTo(map);
			
			
			</script>			
		</div>
	</div>
</body>
</html>